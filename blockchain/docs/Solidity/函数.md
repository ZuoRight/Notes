# 函数

```js
function <函数名> (参数类型 参数名) [函数可见性说明符] [函数权限/功能] [returns(返回值类型和名称)]{
    pass;
    return();
}
```

`this`关键字可以引用合约地址

函数可见性说明符

- private 仅合约内部可见（继承合约不可用）
- internal 仅合约内部可见（继承合约可用），默认
- external 仅合约外部可见（但内部可以用`this.f()`调用）
- public 合约内部外部均可见，给变量加public实际就是创建了getter函数

函数权限/功能

- 默认为空既能读取也能写入状态变量
- view 能读取但是不能写入状态变量，不消耗Gas
- pure 不能读取也不能写入状态变量，不消耗Gas
- payable 可支付的

解构式赋值

```js
uint256 _number;
bool _bool;
uint256[3] memory _array;
// 假设returnNamed()函数有三个返回值
(_number, _bool, _array) = returnNamed();  // 读取所有变量
(, _bool2, ) = returnNamed();  // 读取部分变量
```

## 变量作用域

### 状态变量（state variable）

在合约内、函数外声明，状态变量数据存储在链上，即storage，所有合约内函数都可以访问

### 局部变量（local variable）

在函数内声明，仅在函数执行过程中有效，存储在内存里，不上链

### 全局变量（global variable）

无需声明，是solidity预留关键字，可直接使用

```js
// 常用全局变量
blockhash(uint blockNumber): (bytes32)给定区块的哈希值 – 只适用于256最近区块, 不包含当前区块。
gasleft(): (uint256) 剩余 gas

block.coinbase: (address payable) 当前区块矿工的地址
block.gaslimit: (uint) 当前区块的gaslimit
block.number: (uint) 当前区块的number
block.timestamp: (uint) 当前区块的时间戳，为unix纪元以来的秒

msg.data: (bytes calldata) 完整call data
msg.sender: (address payable) 消息发送者 (当前 caller)
msg.sig: (bytes4) calldata的前四个字节 (function identifier)
msg.value: (uint) 当前交易发送的wei值
```

- `address(this).balance` 智能合约本身的余额，this指的是正在执行的合约实例
- `msg.sender.balance` 进行交易的用户的余额，如果msg.sender是另一个合约，那么它是另一个合约的余额。
