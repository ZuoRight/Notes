# IP

IPv4由32位二进制数组成，通常分割成4组，每组8位（以十进制数表示）

![20210725152948](http://image.zuoright.com/20210725152948.png)

IP组成：起始位+网络号+主机号，据此分成5类

![20210726230202](http://image.zuoright.com/20210726230202.png)

ABC类分别预留了三段IP用于不同规模组织作私有使用

D类为组播地址，向这个IP发送消息，组下的主机都可以收到

![20210725153815](http://image.zuoright.com/20210725153815.png)

但通常使用更灵活的CIDR(无类型域间选路)来表示，类似 `x.x.x.x/n` 这种形式，`/n`表示，前n位为固定的网络号，后(32-n)位为主机号

最常用的为`/24`和`/16`，比如最常见也最好理解的私有网络IP段：`192.168.0.x/24`，前24位为网络号，后8位为主机号，可表示2^8=256个主机，其中

- 192.168.0.0 网络号
- 192.168.0.1 第一个地址
- 192.168.1.1 通常为默认网关
- 192.168.0.255 广播地址（向这个地址发送消息所有主机都可以收到
- 255.255.255.0 子网掩码


![20210725150926](http://image.zuoright.com/20210725150926.png)

6.6.6.6 网关或网桥连接

![20210725151352](http://image.zuoright.com/20210725151352.png)

随着互联网的普及以及个人联网设备数量的增多，可用的大约36.47亿个IPv4地址已经无法满足地球约75亿人口所使用了，于是升级迭代出IPv6协议

IPv6由128位二进制数组成，通常分割成8组，每组16位（以十六进制数表示）

可为地球的每一粒沙子提供唯一IP，但它与IPv4是两个完全不同的协议，需要转换和映射才能数据互通，完全取代IPv4可能还需要很长一段时间。

![20210725152103](http://image.zuoright.com/20210725152103.png)


## IP

配置IP

DHCP动态主机配置协议会分配一个地址

查看IP

Windows: `ipconfig`
Linux/Mac: `ifconfig`(net-tools) 或者 `ip addr`(iproute2)

IPv4地址由32位构成，使用CIDR（无类型域间选路）的方式一分为二，即网络号和主机号
最常用的私有IP地址：192.168.0.x/24（表示）
/24（CIDR形式之一），表示32位中，前24位为网络号（即192.168.0），后8位为主机号（即.x）
子网掩码：255.255.255.0
出口地址：192.168.0.1（电脑连接WiFi，路由器的地址就是这个）
广播地址：192.168.0.255（发送到这个地址，整个网络的机器都能收到）
IP+子网掩码可以得到网络号
lo(loopback，又称环回接口)，往往会被分配到 127.0.0.1 这个地址

MAC物理地址，全局唯一，跟随网卡诞生

一个网络包要从一个地方传到另一个地方，除了要有确定的地址，还需要有定位功能。 而有门牌号码属性的 IP 地址，才是有远程定位功能的。MAC 地址更像是身份证，是一个唯一的标识
MAC 地址的通信范围比较小，局限在一个子网里面

知道那台机器的 IP 地址了，直接发给他消息呗，要 MAC 地址干啥？这里的关键就是，没有 MAC 地址消息是发不出去的。

这里要记住一点：只要是在网络上跑的包，都是完整的。可以有下层没上层，绝对不可能有上层没下层。

1. mac地址是唯一的，为什么可以修改?想想身份证，身份证号是唯一的，不能改变的，但是可以造价。mac地址全球唯一，它是固化在网卡里的。网卡毕竟是个硬件，需要软件支持，既操作系统识别。重点来了，操作系统识别出来的mac地址是可以更改的，它只不过是一个字符串。我们常说的修改mac指的是修改电脑中记录的既注册表中的记录。
2. 有了mac地址为什么还要有ip地址。举个例子，身份证号是你的唯一标识，不会重复，一落户就有（网卡一出厂就有mac）。现在我要和你通信（写信给你），地址用你的姓名+身份证，信能送到你手上吗?明显不能！身份证号前六位能定位你出生的县。mac地址前几位也可以定位生产厂家。但是你出生后会离开这个县（哪怕在这个县，也不能具体找到你）。所以一般写个人信息就要有出生地和现居地址了。

## 查看IP

```shell
# windows
ipconfig

# linux/mac
ifconfig  # 需要安装net-tools，已停止维护
ip addr  # 需要安装iproute2，逐渐取代net-tools，推荐
```

返回字段解析

```shell
# 第一行
eth0: <BROADCAST,MULTICAST,UP,LOWER_UP>  # net_device flags(网络设备状态标识)
    # BROADCAST 表示这个网卡有广播地址，可以发送广播包
    # MULTICAST 表示网卡可以发送多播包
    # UP 表示网卡处于启动的状态
    # LOWER_UP 表示L1是启动的，也即网线插着呢
mtu 1500  # 最大传输单元1500字节(这是以太网的默认值)
    # MAC头后面的正文(包括IP头、TCP头、HTTP头)不允许超过1500个字节，存不下则分片传输
qdisc pfifo_fast  # queueing discipline(排队规则)
    # 内核通过某个网络接口发送数据包时，需要按照这个排队规则将数据包加入队列
state UP

# 第二行
link/ether 00:15:5d:21:b9:ea brd ff:ff:ff:ff:ff:ff  # mac地址

# 第三行
xxx.xx.xxx.x scope global eth0  # ethernet 以太网卡，范围global，对外访问
127.0.0.1/8 scope host lo  # loopback 环回接口，范围host，供本机相互通信
```

## MAC

MAC地址，是网卡出厂自带的物理地址，类似于身份证号具有唯一标识性，仅用于子网内定位，互联网定位还得靠IP。

## 域名

根域名，也叫Root/Apex/naked/bare Domains

## 参考

- 视频：[硬件茶谈](https://www.bilibili.com/video/BV1DD4y127r4)
- 文章：极客时间·[《趣谈网络协议》](https://time.geekbang.org/column/intro/100007101)