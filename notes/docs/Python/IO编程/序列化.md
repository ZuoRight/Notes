# 序列化

程序运行的过程中，所有的变量都是在内存中临时存储，把内存中的变量变为可存储或者可传输的，然后才能存储到磁盘或者数据交换，这个过程称之为序列化，反之，称为反序列化。

## Pickle模块

序列化为bytes类型。

```python
import pickle

# 可以把任意类型变量序列化为bytes类型数据
pickle.dumps(x)

# 可以把序列化后的bytes类型数据，反序列化为原类型，但与之前已经不是同一个变量了
pickle.loads(x)
```

存储为Pickle格式，Python特有，无法跨语言数据交换，不可阅读。

```python
import pickle

# 序列化并存储到文件，必须是“wb”模式
with open("test.pickle", "wb") as f:
    pickle.dump(x, f)

# 直接反序列化文件中的数据，必须是“rb”模式
with open("test.pickle", "rb") as f:
    pickle.load(f)
```

## Json模块

Json规定了其键以及字符串都必须用双引号括起来，字符集必须是UTF-8。

序列化为str类型

```python
import json

json.dumps(x)

json.loads('x')
```

存储为Json格式，标准格式，通用，可阅读。

bytes、set类型没有对应的json格式，可分别转为str或list后再序列化

```python
import json

# 序列化并存储到json文件
with open("test.json", "w") as f:
    json.dump(x, f)

# 从json文件中反序列化
with open("test.json", "r") as f:
    result = json.load(f)
    # 或者
    # result = json.loads(f.read())
```

序列化并格式化

```python
import json

data = {
    "A": {
        1: "a1",
        2: "b1",
        3: "c1",
    },
    "B": {
        1: "a2",
        2: "b2",
        3: "c2",
    }
}

# indent  设置缩进显示成几个空格
# ensure_ascii  是否显示ascii码，默认为true，如果要显示中文需要设置为false
# sort_keys  是否按照字母排序
# separators  设置分隔符
result = json.dumps(data, indent=4, ensure_ascii=False, sort_keys=True, separators=(“,”, ‘: ‘))
```


